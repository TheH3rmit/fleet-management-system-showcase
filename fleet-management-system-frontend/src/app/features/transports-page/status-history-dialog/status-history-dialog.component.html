<h2 mat-dialog-title>Status history</h2>

<div mat-dialog-content class="content">
  <div class="toolbar">
    <div class="muted">Transport #{{ transportId }}</div>
    <span class="spacer"></span>

    <button mat-stroked-button type="button" (click)="reload()" [disabled]="loading()">
      <mat-icon>refresh</mat-icon>
      Refresh
    </button>
  </div>

  <div class="table-wrapper mat-elevation-z2" *ngIf="!loading()">
    <table
      mat-table
      [dataSource]="rows()"
      matSort
      (matSortChange)="onSort($event)"
      class="full-width"
    >
      <ng-container matColumnDef="changedAt">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Changed at</th>
        <td mat-cell *matCellDef="let r">{{ r.changedAt | date:'short' }}</td>
      </ng-container>

      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
        <td mat-cell *matCellDef="let r">{{ r.status }}</td>
      </ng-container>

      <ng-container matColumnDef="changedBy">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>By</th>
        <td mat-cell *matCellDef="let r">
          {{ r.changedByUserId ? ('#' + r.changedByUserId) : 'â€”' }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="cols"></tr>
      <tr mat-row *matRowDef="let row; columns: cols"></tr>
    </table>
  </div>

  <div class="loading" *ngIf="loading()">
    <mat-progress-spinner diameter="28" mode="indeterminate"></mat-progress-spinner>
  </div>

  <mat-paginator
    [length]="total"
    [pageIndex]="pageIndex()"
    [pageSize]="pageSize()"
    [pageSizeOptions]="[5, 10, 20]"
    (page)="onPage($event)"
  ></mat-paginator>

  <div *ngIf="!loading() && total === 0" class="muted" style="margin-top: .5rem;">
    No history entries.
  </div>
</div>

<div mat-dialog-actions align="end">
  <button mat-stroked-button type="button" (click)="close()">Close</button>
</div>
